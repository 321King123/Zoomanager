<app-alert [alertComponentId]="componentId"></app-alert>
<div class="row mt-5">
  <div class="col-12">
    <h5>Current Tasks</h5>
  </div>
</div>
<div class="animal-list-header mt-4">
  <table class="table table-striped table-hover dt-responsive">
    <thead>
    <tr class="row">
      <th class="col" scope="col">Title</th>
      <th class="col" scope="col">Begin</th>
      <th class="col" scope="col">End</th>
      <th class="col" scope="col">Assignee</th>
      <th class="col" scope="col">
        <button *ngIf="!deleteFollowing" (click)="changeDeleteState()" class="btn my-0 btn-secondary btn-sm">Delete with following</button>
        <button *ngIf="deleteFollowing" (click)="changeDeleteState()" class="btn my-0 btn-primary btn-sm">Delete without following</button>
      </th>
    </tr>
    </thead>
    <tbody *ngIf="tasks!=null">

    <ng-container *ngFor="let task of tasks; index as i;">
      <tr class="row animal-list-item" [class.alert-warning]="task.priority">
        <td class="col" >{{task.title}}</td>
      <!--  <td class="col">

          <p *ngIf="!task.priority">Normal</p>
        </td> -->
        <td class="col">{{task.startTime}}</td>
        <td class="col">{{task.endTime}}</td>
        <ng-container *ngIf="task.assignedEmployeeUsername!=null">
          <td class="col">{{task.assignedEmployeeUsername}}</td>
        </ng-container>
        <ng-container *ngIf="task.assignedEmployeeUsername==null">
          <td class="col">
            <app-assign-task (assignmentSuccessful)="reloadTasks.emit()" [index]="i"
                             [employees]="employees" [doctors]="doctors" [janitors]="janitors" [task]="task"></app-assign-task>
          </td>
        </ng-container>
        <td class="col d-flex justify-content-end align-items-baseline">
          <ng-container *ngIf="task.priority">âœª </ng-container>
          <ng-container *ngIf="task.status!='DONE'">
            <button (click)="markTaskAsDone(task.id)" class="btn mx-2 btn-sm btn-outline-success">Done!</button>
          </ng-container>
          <ng-container *ngIf="task.status=='DONE'">
            <div class="mx-2"> Done!</div>
          </ng-container>
          <app-task-info-update (reloadTasks)="reloadTasks.emit()" *ngIf="currentUserType!=='DOCTOR' && currentUserType!=='JANITOR'"
                                [animalsOfEmployee]="animalsOfEmployee" [enclosuresOfEmployee]="enclosuresOfEmployee" [task]="task" [index]="i"></app-task-info-update>
          <button *ngIf="currentUserType!=='DOCTOR' && currentUserType!=='JANITOR'" (click)="deleteTask(task.id)"
                  class="btn-sm btn-outline-danger btn">Delete
          </button>
        </td>
      </tr>
    </ng-container>


    </tbody>
  </table>
</div>

